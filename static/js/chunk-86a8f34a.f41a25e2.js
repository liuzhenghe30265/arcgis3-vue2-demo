(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-86a8f34a"],{"2ffe":function(e,r,t){"use strict";t.r(r);var i=function(){var e=this,r=e._self._c;return r("div",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"map-container"}},[r("div",{staticStyle:{position:"absolute",right:"50px",top:"50px","z-index":"999",width:"200px"}},[r("el-tree",{ref:"tree2",attrs:{data:e.treeData2,"show-checkbox":"","node-key":"id","highlight-current":""},on:{"check-change":e.handleCheckChange2}}),r("hr"),r("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.defaultProps,"show-checkbox":"","node-key":"id","highlight-current":""},on:{"check-change":e.handleCheckChange}})],1)])},s=[],o=t("afaa"),a={name:"MapServer",data(){return{SF311Layer:null,DamageAssessmentLayer:null,haveSublayers:null,defaultProps:{children:"children",label:"label"},treeData2:[{label:"StoryMapPlaces5",id:"StoryMapPlaces5"},{label:"StoryMapPlaces7",id:"StoryMapPlaces7"}],treeData:[{label:"Cities",id:0},{label:"Highways",id:1},{label:"States",id:2},{label:"Counties",id:3}],map:"",gisConstructor:{},gisModules:["esri/SpatialReference","esri/Color","esri/symbols/TextSymbol","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/PictureMarkerSymbol","esri/symbols/Font","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/geometry/geometryEngine","esri/layers/GraphicsLayer","esri/graphic","dojo/_base/declare","esri/layers/FeatureLayer","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/geometry/Extent","esri/map"]}},mounted(){this.init()},methods:{handleCheckChange2(){let e=this.$refs.tree2.getCheckedKeys(),r=this.treeData2.map(e=>e.label);r.forEach(e=>{let r=this.map.getLayer(e);r.setVisibility(!1)}),e.forEach(e=>{let r=this.map.getLayer(e);r.setVisibility(!0)})},handleCheckChange(){let e=this.$refs.tree.getCheckedKeys(),r=this.map.getLayer("DamageAssessment");r.setVisibility(!1),r.setVisibility(!0),r.setVisibleLayers(e)},loadLayersFun(){const e=[{url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/StoryMaps/StoryMapPlaces5/MapServer",id:"StoryMapPlaces5",opacity:1,visible:!1,type:"dynamic"},{url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/StoryMaps/StoryMapPlaces7/MapServer",id:"StoryMapPlaces7",opacity:1,visible:!1,type:"dynamic"},{url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/USA/MapServer",id:"DamageAssessment",opacity:.5,visible:!1,type:"dynamic"}];e.forEach(e=>{if("dynamic"===e.type){let r=new this.gisConstructor.ArcGISDynamicMapServiceLayer(e.url,{id:e.id,opacity:e.opacity||1,visible:e.visible});this.map.addLayer(r)}});let r=this.map.getLayer("DamageAssessment");console.log(r.layerInfos),r.loaded?console.log(r.layerInfos):dojo.connect(r,"onLoad",e=>{console.log(e.layerInfos)});let t=new this.gisConstructor.GraphicsLayer({id:"高亮图层"});this.map.addLayer(t);let i=new this.gisConstructor.FeatureLayer("https://sampleserver6.arcgisonline.com/arcgis/rest/services/USA/MapServer/3",{mode:this.gisConstructor.FeatureLayer.MODE_ONDEMAND,outFields:["*"],opacity:0});this.map.addLayer(i),i.on("mouse-over",e=>{let r=this.$refs.tree.getCheckedKeys();if(e.graphic&&r.indexOf(3)>-1){let r=e.graphic.attributes,i=e.graphic.geometry,s=(new this.gisConstructor.SimpleFillSymbol).setColor(new this.gisConstructor.Color([255,0,0,.3]));s.setOutline(new this.gisConstructor.SimpleLineSymbol(this.gisConstructor.SimpleLineSymbol.STYLE_SOLID,new this.gisConstructor.Color([255,0,0]),3));let o=new this.gisConstructor.graphic(i,s);t.add(o);let a=i.getExtent().getCenter(),n=new this.gisConstructor.TextSymbol(r.name,new this.gisConstructor.Font("12px"),new this.gisConstructor.Color([255,0,0])),l=this.gisConstructor.Color("#fff");n.setHaloColor(l).setHaloSize(2);let c=new this.gisConstructor.graphic(a,n,r);t.add(c)}else t.clear()}),i.on("mouse-out",()=>{t.clear()})},mapClickFun(){this.map.on("click",e=>{console.log(e)})},init(){Object(o["loadCss"])("https://js.arcgis.com/3.32/esri/css/esri.css"),Object(o["loadModules"])(this.gisModules,{url:"https://js.arcgis.com/3.32/"}).then(this.initMap).then(this.loadLayersFun).then(this.mapClickFun)},initMap(e){for(let t in e){let r=this.gisModules[t].split("/").pop();this.gisConstructor[r]=e[t]}this.map=new this.gisConstructor.map("map-container",{basemap:"hybrid",logo:!1,slider:!0});let r={xmin:-178.217598382,ymin:18.921786345999976,xmax:-66.96927110500002,ymax:71.40623554799998};this.map.setExtent(new this.gisConstructor.Extent(r.xmin,r.ymin,r.xmax,r.ymax))}}},n=a,l=t("2877"),c=Object(l["a"])(n,i,s,!1,null,null,null);r["default"]=c.exports},afaa:function(e,r,t){(function(e,t){t(r)})(0,(function(e){"use strict";var r="4.17",t="next";function i(e){if(e.toLowerCase()===t)return t;var r=e&&e.match(/^(\d)\.(\d+)/);return r&&{major:parseInt(r[1],10),minor:parseInt(r[2],10)}}function s(e){return void 0===e&&(e=r),"https://js.arcgis.com/"+e+"/"}function o(e){void 0===e&&(e=r);var o=s(e),a=i(e);if(a!==t&&3===a.major){var n=a.minor<=10?"js/":"";return""+o+n+"esri/css/esri.css"}return o+"esri/themes/light/main.css"}function a(e){var r=document.createElement("link");return r.rel="stylesheet",r.href=e,r}function n(e,r){if(r){var t=document.querySelector(r);t.parentNode.insertBefore(e,t)}else document.head.appendChild(e)}function l(e){return document.querySelector('link[href*="'+e+'"]')}function c(e){return!e||i(e)?o(e):e}function d(e,r){var t=c(e),i=l(t);return i||(i=a(t),n(i,r)),i}var u="undefined"!==typeof window,h={Promise:u?window["Promise"]:void 0},p={};function m(e){var r=document.createElement("script");return r.type="text/javascript",r.src=e,r.setAttribute("data-esri-loader","loading"),r}function y(e,r,t){var i;t&&(i=g(e,t));var s=function(){r(e),e.removeEventListener("load",s,!1),i&&e.removeEventListener("error",i,!1)};e.addEventListener("load",s,!1)}function g(e,r){var t=function(i){r(i.error||new Error("There was an error attempting to load "+e.src)),e.removeEventListener("error",t,!1)};return e.addEventListener("error",t,!1),t}function f(e){void 0===e&&(e={}),p=e}function v(){return document.querySelector("script[data-esri-loader]")}function S(){var e=window["require"];return e&&e.on}function b(e){void 0===e&&(e={});var r={};[p,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}));var t=r.version,i=r.url||s(t);return new h.Promise((function(e,s){var o=v();if(o){var a=o.getAttribute("src");a!==i?s(new Error("The ArcGIS API for JavaScript is already loaded ("+a+").")):S()?e(o):y(o,e,s)}else if(S())s(new Error("The ArcGIS API for JavaScript is already loaded."));else{var n=r.css;if(n){var l=!0===n;d(l?t:n,r.insertCssBefore)}r.dojoConfig&&(window["dojoConfig"]=r.dojoConfig),o=m(i),y(o,(function(){o.setAttribute("data-esri-loader","loaded"),e(o)}),s),document.body.appendChild(o)}}))}function C(e){return new h.Promise((function(r,t){var i=window["require"].on("error",t);window["require"](e,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.remove(),r(e)}))}))}function w(e,r){if(void 0===r&&(r={}),S())return C(e);var t=v(),i=t&&t.getAttribute("src");return!r.url&&i&&(r.url=i),b(r).then((function(){return C(e)}))}var L={getScript:v,isLoaded:S,loadModules:w,loadScript:b,loadCss:d,setDefaultOptions:f,utils:h};e.getScript=v,e.isLoaded=S,e.loadModules=w,e.loadScript=b,e.loadCss=d,e.setDefaultOptions=f,e.utils=h,e["default"]=L,Object.defineProperty(e,"__esModule",{value:!0})}))}}]);